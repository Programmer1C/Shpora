Процедура РассчитатьНачисления(Регистратор) Экспорт
	
	НаборЗаписей = РегистрыРасчета.ОсновныеНачисления.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.Регистратор.Установить (Регистратор);
	НаборЗаписей.Прочитать();
	
	//Оклад
	Запрос=Новый Запрос;
	Запрос.Текст="ВЫБРАТЬ
	             |	ОсновныеНачисленияДанныеГрафика.НомерСтроки,
	             |	ОсновныеНачисленияДанныеГрафика.КоличествоЧасовФактическийПериодДействия КАК ЧасовФакт,
	             |	ЕСТЬNULL(ЗначенияОклада.Оклад, 0) КАК Оклад,
	             |	ОсновныеНачисленияДанныеГрафика.КоличествоЧасовПериодДействия КАК ЧасовПлан
	             |ИЗ
	             |	РегистрРасчета.ОсновныеНачисления.ДанныеГрафика(
	             |			Регистратор = &Регистратор
	             |				И ВидРасчета = &ВидРасчетаОклад) КАК ОсновныеНачисленияДанныеГрафика
	             |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияОклада КАК ЗначенияОклада
	             |		ПО ОсновныеНачисленияДанныеГрафика.Подразделение = ЗначенияОклада.Подразделение
	             |			И ОсновныеНачисленияДанныеГрафика.КоличествоЧасовФактическийПериодДействия >= ЗначенияОклада.ЧасовОт
	             |			И ОсновныеНачисленияДанныеГрафика.КоличествоЧасовФактическийПериодДействия < ЗначенияОклада.ЧасовДо";
	
	Запрос.УстановитьПараметр("Регистратор", Регистратор);
	Запрос.УстановитьПараметр("ВидРасчетаОклад", ПланыВидовРасчета.ОсновныеНачисления.Оклад);
	
	
	СтруктураПоиска=Новый Структура;
	СтруктураПоиска.Вставить("НомерСтроки", 0);
	
	Выборка=Запрос.Выполнить().Выбрать();
	Для Каждого Запись Из НаборЗаписей Цикл
		СтруктураПоиска.НОмерСтроки=Запись.НомерСтроки;
		Если Выборка.НайтиСледующий(СтруктураПоиска) Тогда
			Запись.Результат=?(Выборка.ЧасовПлан=0, 0, Выборка.ЧасовФакт/Выборка.ЧасовПлан * Выборка.Оклад);
			Запись.ОтработаноЧасов=Выборка.ЧасовФакт;
		КонецЕсли;
		Выборка.Сбросить();
	КонецЦикла;
	
	
	//Штраф за опоздание
	Запрос=Новый Запрос;
	Запрос.Текст="ВЫБРАТЬ
	             |	ОсновныеНачисленияДанныеГрафика.НомерСтроки,
	             |	ЕСТЬNULL(ОсновныеНачисленияДанныеГрафика.КоличествоПятнадцатиминутокФактическийПериодДействия, 0) КАК КоличествоПятнадцитиминуток
	             |ИЗ
	             |	РегистрРасчета.ОсновныеНачисления.ДанныеГрафика(
	             |			Регистратор = &Регистратор
	             |				И ВидРасчета = &ВидРасчетаШТрафЗаОпоздание) КАК ОсновныеНачисленияДанныеГрафика";
	
	Запрос.УстановитьПараметр("Регистратор", Регистратор);
	Запрос.УстановитьПараметр("ВидРасчетаШтрафЗаОпоздание", ПланыВидовРасчета.ОсновныеНачисления.ШтрафЗаОпоздание);
	
	СтруктураПоиска=Новый Структура;
	СтруктураПоиска.Вставить("НомерСтроки", 0);
	
	Выборка=Запрос.Выполнить().Выбрать();
	Для Каждого Запись Из НаборЗаписей Цикл
		СтруктураПоиска.НОмерСтроки=Запись.НомерСтроки;
		Если Выборка.НайтиСледующий(СтруктураПоиска) Тогда
			Запись.Результат=Выборка.КоличествоПятнадцитиминуток * 100;
		КонецЕсли;
		Выборка.Сбросить();
	КонецЦикла;
	
	
	НаборЗаписей.Записать(,Истина);
	
	
	//Надбавка
	ДопНаборЗаписей = РегистрыРасчета.ДопНачисления.СоздатьНаборЗаписей();
	ДопНаборЗаписей.Отбор.Регистратор.Установить (Регистратор);
	ДопНаборЗаписей.Прочитать();
	
	Запрос.Текст="ВЫБРАТЬ
	             |	ДопНачисления.НомерСтроки,
	             |	ДопНачисления.ПроцентНадбавки,
	             |	ДопНачисления.СуммаПродаж
	             |ИЗ
	             |	РегистрРасчета.ДопНачисления КАК ДопНачисления
	             |ГДЕ
	             |	ДопНачисления.Регистратор = &Регистратор";
	
	Выборка=Запрос.Выполнить().Выбрать();
	Для Каждого Запись Из ДопНаборЗаписей Цикл
		СтруктураПоиска.НОмерСтроки=Запись.НомерСтроки;
		Если Выборка.НайтиСледующий(СтруктураПоиска) Тогда
			Запись.Результат=Выборка.СуммаПродаж * Выборка.ПроцентНадбавки / 100;
		КонецЕсли;
		Выборка.Сбросить();
	КонецЦикла;
	
	ДопНаборЗаписей.Записать(,Истина); 
	
	
КонецПроцедуры
